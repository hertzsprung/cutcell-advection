\documentclass[times]{elsarticle}
\usepackage{fullpage}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{xcolor}
\usepackage{bm}
\usepackage{natbib}
\usepackage[hidelinks]{hyperref}
\usepackage{doi}
\usepackage[final,babel]{microtype}
\usepackage[utf8]{inputenc}
\usepackage[british]{babel}
\usepackage{csquotes}
\usepackage[T1]{fontenc}
\usepackage{siunitx}
\usepackage[font={small}]{caption}

\newcommand{\iu}{{i\mkern1mu}}
\newcommand{\iunit}{\boldsymbol{\hat \imath}}
\newcommand{\junit}{\boldsymbol{\hat \jmath}}
\newcommand{\kunit}{\boldsymbol{\hat k}}
\newcommand{\TODO}[1]{\textcolor{purple}{TODO: \emph{#1}}}

\begin{document}

\begin{frontmatter}
\title{A finite volume transport scheme for atmospheric flows over steep terrain \\ \TODO{(working title)}}
\author[uor]{James Shaw\corref{cor}}
\ead{js102@zepler.net}
\author[uor]{Hilary Weller}

\cortext[cor]{Corresponding author}
\address[uor]{Department of Meteorology, University of Reading, Reading, United Kingdom}

\begin{abstract}
	\TODO{abstract}
\end{abstract}

\begin{keyword}
	\TODO{keywords}
\end{keyword}
\end{frontmatter}

\section{Introduction}

First, we present a multidimensional advection scheme that is computationally cheap and suitable for complex flows on a variety of meshes.  Second, we present a new type of Cartesian mesh, the slanted cell mesh, that avoids the small cell problem associated with cut cell meshes.   We apply the advection scheme to tests over steep orography and show that accurate results are obtained on slanted cell meshes.  Finally, we challenge the multidimensional advection scheme using a test of deformational flow on a geodesic mesh.

slantedCell motivation
\begin{itemize}
	\item operational models use terrain-following coordinates that can degrade the accuracy of pressure gradient calculations and horizontal transport
	\item the cut cell method can improve pressure gradient accuracy and more accurately represent horizontal transport, but the cut cell method suffers from the small cell problem
	\item the slanted cell method is an alternative presented in \citep{shaw-weller2016} that avoids the small cell problem whilst retaining accurate pressure gradient calculations and horizontal transport
\end{itemize}

cubicFit motivation
\begin{itemize}
	\item finite volume is desirable because it's inherently conservative, \TODO{what else?  FV3 do it, ECMWF are doing it}
	\item a transport scheme for arbitrary meshes is desirable because different meshes offer different trade-offs (\TODO{e.g. provide example for icosahedra vs cubed-sphere and citation}).  supporting arbitrary meshes lets us defer the choice of mesh.
	\item predicting meteorological variables at or near the surface is important because it's where we live, clouds can form near the surface, fog, pollution $\Rightarrow$ accurate advection is desirable
	\item cubicFit offers a good balance between accuracy and computational cost, and achieves accurate results near the ground
\end{itemize}

\TODO{why isn't linearUpwind good enough?  what other schemes compete with cubicFit and what can cubicFit offer in comparison with these competitors?}

\TODO{cubicFit belongs to a new class of finite volume transport scheme that use a least squares fit to approximate face values (is this true? what about OpenFOAM's existing \texttt{xxxFit} schemes?)}

\section{Types of meshes}
\subsection{Meshes for representing terrain}
\label{sec:meshes-terrain}

\TODO{describe BTF, cut cell method and slanted cell method.  Cite ASAM for the cut cell method.  Describe slanted cell method and cite \citep{shaw-weller2016}.}

\begin{equation}
	z = \left( H - h \right) \left( z^\star / H \right) + h \label{eqn:btf}
\end{equation}

\subsection{Meshing a spherical Earth}

\TODO{Describe icosahedral meshes (cite one or more of \citep{thuburn2014,heikes-randall1995a,heikes-randall1995b})} \\
\TODO{Describe cubed-sphere mesh (cite someone?)}

Following appendix A9 in \citep{lauritzen2014}, the average equatorial spacing $\Delta \lambda$ is used as a measure of mesh spacing.  It is defined as
\begin{align}
	\Delta \lambda = \ang{360} \frac{\overline{\Delta x}}{2 \pi R_e}
\end{align}
where $\overline{\Delta x}$ is the mean distance between cell centres and $R_e = \SI{6.3712e6}{\meter}$ is the radius of the Earth.

\input{transportSchemes}

\section{Results}
\label{sec:results}

\TODO{the `slug' advection test case makes slanted cells look bad compared to BTF.  should we redress the balance with a different test?}
\TODO{somewhere mention that the second-order convergence is a limitation of the divergence discretisation.  With more DoF a higher order should be achievable.} \\
\TODO{should I do eigenmode analysis?  this would prove stability for particular meshes for arbitrary wind fields} \\
\TODO{somewhere define error norms}

\input{mountainAdvection}

\input{deformationSphere}

\section{Conclusions}

The advection scheme is
\begin{itemize}
	\item suitable for complex flows on a variety of meshes
	\item computationally cheap at runtime, with more expensive computations depending only on the mesh geometry
	\item \TODO{convergence}
	\item stable for Courant numbers up to 1
\end{itemize}

\section{Acknowledgements}
\TODO{Supervisors, funding bodies.  ASAM group for the mesh generator---I should ask permission to use cut cell meshes in this paper.  Dr Tristan Pryer.  Dr Shing Hing Man.}

\input{vonNeumann}

\bibliographystyle{ametsoc2014}
\bibliography{references}

\end{document}

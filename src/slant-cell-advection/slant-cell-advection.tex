\documentclass[times]{elsarticle}
\usepackage{fullpage}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{xcolor}
\usepackage{bm}
\usepackage{natbib}
\usepackage[hidelinks]{hyperref}
\usepackage{doi}
\usepackage[final,babel]{microtype}
\usepackage[utf8]{inputenc}
\usepackage[british]{babel}
\usepackage{csquotes}
\usepackage[T1]{fontenc}
\usepackage{siunitx}
\usepackage[font={small}]{caption}
%\usepackage{mathabx}

\newcommand{\iu}{{i\mkern1mu}}
\newcommand{\iunit}{\boldsymbol{\hat \imath}}
\newcommand{\junit}{\boldsymbol{\hat \jmath}}
\newcommand{\kunit}{\boldsymbol{\hat k}}
\newcommand{\TODO}[1]{\textcolor{purple}{TODO: \emph{#1}}}

\begin{document}

\begin{frontmatter}
\title{An Eulerian finite volume transport scheme for atmospheric flows on arbitrary meshes over steep terrain}
\author[uor]{James Shaw\corref{cor}}
\ead{js102@zepler.net}
\author[uor]{Hilary Weller}
\author[uor]{John Methven}
\author[mo]{Terry Davies}

\cortext[cor]{Corresponding author}
\address[uor]{Department of Meteorology, University of Reading, Reading, United Kingdom}
\address[mo]{Met Office, Exeter, United Kingdom}

\begin{abstract}
The inclusion of terrain in atmospheric models gives rise to mesh distortions near the lower boundary that can degrade the accuracy and challenge the stability of transport schemes \TODO{apart from linearUpwind results, what evidence do I have that other transport schemes struggle with stability over steep slopes?}.
In addition, accuracy may be compromised because of stringent time-to-solution constraints on operational weather forecast models.

This paper presents an Eulerian finite volume transport scheme, ``cubicFit'', that uses a multidimensional polynomial, least squares reconstruction method.  Constraints derived from a von Neumann stability analysis are imposed during model initialisation to remove high-order terms from the reconstruction polynomial in distorted regions of the mesh, or near boundaries where there is insufficient information.
This technique achieves stable, non-oscillatory solutions on arbitrarily distorted, non-uniform meshes.  The least squares reconstruction method has a low computational cost because most calculations depend upon the mesh only, with just one vector multiply per face needed per time-step.

The cubicFit scheme is evaluated using two, idealised numerical tests of atmospheric flow.  The first test assesses accuracy near the ground by transporting a tracer over steep terrain on severely distorted terrain-following meshes and cut-cell meshes.  The second test deforms a tracer in non-divergent and divergent flows on hexagonal icosahedra and cubed-sphere meshes.
In all tests, cubicFit is largely insensitive to mesh distortions, and cubicFit results are more accurate than those obtained using a standard linear upwind transport scheme.
\end{abstract}

\begin{keyword}
	\TODO{keywords}
\end{keyword}
\end{frontmatter}

\section{Introduction}
\input{intro}

\input{transportSchemes}

\section{Results}
\label{sec:results}

\TODO{somewhere mention that the second-order convergence is a limitation of the divergence discretisation.  With more DoF a higher order should be achievable.} \\
\TODO{I might need to estimate the number of floating-point ops to enable a comparison between linearUpwind and cubicFit in terms of computational expense versus numerical accuracy}

\input{mountainAdvection}

\input{deformationSphere}

\section{Conclusions}

The advection scheme is
\begin{itemize}
	\item suitable for complex flows on a variety of meshes
	\item computationally cheap at runtime, with more expensive computations depending only on the mesh geometry
	\item \TODO{convergence}
	\item stable for Courant numbers up to 1
\end{itemize}

\section{Acknowledgements}
\TODO{Supervisors, funding bodies.  ASAM group for the mesh generator---I should ask permission to use cut cell meshes in this paper.  Dr Tristan Pryer.  Dr Shing Hing Man.}

\input{vonNeumann}

\input{spherical}

\bibliographystyle{elsarticle-num}
\bibliography{references}

\end{document}

Polynomial fit interpolation
============================

Here we explain how an interpolated value is obtained at a target face by fitting a polynomial surface onto a stencil of points.  In particular, this document focuses on the stabilisation procedure.

In two dimensions, the polynomial surface comprises nine terms, and a typical stencil in the interior of a quadritaleral mesh has twelve points.  A matrix is constructed having one row per stencil point.  Typically, the matrix has one column per polynomial term, though it may have fewer columns for particular stencil geometries.  The polynomial surface is fitted to the stencil point values using a least squares approach.

The stencils points adjacent to the target face are called *central points*.  The central point that is upwind is called the *upwind point*, and the other is called the *downwind point*.  For a typical stencil geometry, the central points are given a large weighting in the least squares fit so that the polynomial surface passes almost exactly through these two points.  We refer to these collectively as the *central weights*, with the *upwind weight* and *downwind weight* applying to the upwind and downwind points individually.  At the time of writing, for typical stencil geometries, the central weights are 1000, and all other stencil points are given a weight of 1.

A least square fit is obtained by applying a singular value decomposition to the matrix.  This yields a vector of *coefficients* which is dotted with the stencil point values to obtain the interpolated value at the target face.  Note the distinction between *weights*, which are applied during the construction of the matrix, and *coefficients*, which are the output of the least squares fit.

In order to achieve numerical stability, the matrix may be manipulated for particular stencil geometries in two ways: by removing columns from the matrix, and by adjusting the stencil point weights.  For each flux direction through each face, the procedure is as follows:

1. The matrix is constructed one column at a time.  The columns corresponding to the lowest order terms are appended first, and the columns corresponding to the highest order terms are appended last.  After each column is appended, the singular values are examined to determine if the matrix is full-rank.  If any singular value is smaller than the threshold value, the matrix is considered rank-deficient (at the time of writing, the threshold value is 1e-2).  If the matrix is full-rank then we append another column corresponding to the next lowest-order term.  Otherwise if matrix becomes rank-deficient having appended a column, then that column is removed from the matrix and another column is tried, corresponding to the next lowest-order term.
2. When the previous step is complete, the result is a full-rank matrix with up to nine columns.  Next, we check if the upwind and downwind coefficients, c\_U and c\_D, satisfy the von Neumann stability criteria: |c_D| < c_U <= 1 + c\_D and c_U >= 0.5.  If the criteria are satisified, we move on to the next step.  Otherwise, we remove the right-most column, corresponding to the highest-order term, and check again to see if the stability criteria are satisfied.  This process continues until the coefficients are considered stable, or the matrix has no columns remaining.
3. If stability has still not been achieved, we return to the full-rank matrix generated by step 1.  The downwind weight is decreased by one and a new vector of coefficients is generated.  This step is repeated until the stability criteria are satisified, or the downwind weight reaches one.
4. If step 3 did not yield a stable vector of coefficients, we abandon the high-order approximation and resort to a first-order upwind scheme which assumes that the target face value is equal to the upwind point value.

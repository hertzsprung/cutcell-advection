\documentclass[times]{elsarticle}
\usepackage{fullpage}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{xcolor}
\usepackage{bm}
\usepackage{natbib}
\usepackage[hidelinks]{hyperref}
\usepackage{doi}
\usepackage[final,babel]{microtype}
\usepackage[utf8]{inputenc}
\usepackage[british]{babel}
\usepackage{csquotes}
\usepackage[T1]{fontenc}
\usepackage{siunitx}
\usepackage[font={small}]{caption}

\newcommand{\iu}{{i\mkern1mu}}
\newcommand{\iunit}{\boldsymbol{\hat \imath}}
\newcommand{\junit}{\boldsymbol{\hat \jmath}}
\newcommand{\kunit}{\boldsymbol{\hat k}}
\newcommand{\TODO}[1]{\textcolor{purple}{TODO: \emph{#1}}}

\begin{document}

\begin{frontmatter}
\title{An Eulerian finite volume transport scheme for atmospheric flows on arbitrary meshes over steep terrain \\ \TODO{(working title)}}
\author[uor]{James Shaw\corref{cor}}
\ead{js102@zepler.net}
\author[uor]{Hilary Weller}

\cortext[cor]{Corresponding author}
\address[uor]{Department of Meteorology, University of Reading, Reading, United Kingdom}

\begin{abstract}
The inclusion of terrain in atmospheric models gives rise to mesh distortions and nonuniformities near the lower boundary that can degrade the accuracy of transport schemes.  In addition, accuracy may be compromised because of stringent time-to-solution constraints on operational weather forecast models.

This paper presents an Eulerian finite volume transport scheme, ``cubicFit'', that uses a multidimensional polynomial, least squares reconstruction method.  Constraints derived from a von Neumann stability analysis are imposed during model initialisation to remove high-order polynomial terms in distorted regions of the mesh, or near boundaries where there is insufficient information.  This technique achieves stable, non-oscillatory solutions on arbitrarily distorted, nonuniform meshes.  The least squares reconstruction method is computationally cheap because most calculations depend upon the mesh only, with just one vector-vector multiply per face needed per time-step.

The cubicFit scheme is evaluated using two, idealised numerical tests of atmospheric flow.  The first test assesses accuracy near the ground by transporting a tracer over steep terrain on severely distorted terrain-following meshes and cut cell meshes.  The second test deforms a tracer in non-divergent and divergent flows on hexagonal icosahedra and cubed-sphere meshes.
In all tests, cubicFit is largely insensitive to mesh distortions, and cubicFit results are more accurate than those obtained using a standard linear upwind transport scheme.
\end{abstract}

\begin{keyword}
	\TODO{keywords}
\end{keyword}
\end{frontmatter}

\section{Introduction}
\input{intro}

\section{Meshes}

The basic terrain-following method uses a linear decay function so that mesh surfaces become horizontal at the top of the model domain \citep{galchen-somerville1975},
\begin{equation}
	z(x,y) = \left( H - h(x,y) \right) \left( z^\star / H \right) + h(x,y) \label{eqn:btf}
\end{equation}
where $z$ is the geometric height at a horizontal point $(x, y)$, $H$ is the height of the domain, $h(x,y)$ is the surface elevation and $z^\star$ is the computational height of a mesh surface.  If there was no terrain then $h = 0$ and $z = z^\star$.

\subsection{Meshing a spherical Earth}

\begin{figure}
	\caption{\TODO{a plot of low-res cubed-sphere and hexagonal icosahedral meshes}}
\end{figure}

\TODO{Describe hexagonal icosahedral meshes (cite one or more of \citep{thuburn2014,heikes-randall1995a,heikes-randall1995b})} \\
\TODO{Describe cubed-sphere mesh (cite someone?)}

Following appendix A9 in \citep{lauritzen2014}, the average equatorial spacing $\Delta \lambda$ is used as a measure of mesh spacing.  It is defined as
\begin{align}
	\Delta \lambda = \ang{360} \frac{\overline{\Delta x}}{2 \pi R_e}
\end{align}
where $\overline{\Delta x}$ is the mean distance between cell centres and $R_e = \SI{6.3712e6}{\meter}$ is the radius of the Earth.

\input{transportSchemes}

\section{Results}
\label{sec:results}

\TODO{somewhere mention that the second-order convergence is a limitation of the divergence discretisation.  With more DoF a higher order should be achievable.} \\
\TODO{should I do eigenmode analysis?  this would prove stability for particular meshes for arbitrary wind fields} \\
\TODO{somewhere define error norms}
\TODO{I might need to estimate the number of floating-point ops to enable a comparison between linearUpwind and cubicFit in terms of computational expense versus numerical accuracy}

\input{mountainAdvection}

\input{deformationSphere}

\section{Conclusions}

The advection scheme is
\begin{itemize}
	\item suitable for complex flows on a variety of meshes
	\item computationally cheap at runtime, with more expensive computations depending only on the mesh geometry
	\item \TODO{convergence}
	\item stable for Courant numbers up to 1
\end{itemize}

\section{Acknowledgements}
\TODO{Supervisors, funding bodies.  ASAM group for the mesh generator---I should ask permission to use cut cell meshes in this paper.  Dr Tristan Pryer.  Dr Shing Hing Man.}

\input{vonNeumann}

\bibliographystyle{elsarticle-num}
\bibliography{references}

\end{document}

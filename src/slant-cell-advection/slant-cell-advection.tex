\documentclass[times]{elsarticle}
\usepackage{fullpage}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{xcolor}
\usepackage{bm}
\usepackage{natbib}
\usepackage[hidelinks]{hyperref}
\usepackage{doi}
\usepackage[final,babel]{microtype}
\usepackage[utf8]{inputenc}
\usepackage[british]{babel}
\usepackage{csquotes}
\usepackage[T1]{fontenc}
\usepackage{siunitx}
\usepackage[font={small}]{caption}

\newcommand{\iu}{{i\mkern1mu}}
\newcommand{\iunit}{\boldsymbol{\hat \imath}}
\newcommand{\junit}{\boldsymbol{\hat \jmath}}
\newcommand{\kunit}{\boldsymbol{\hat k}}
\newcommand{\TODO}[1]{\textcolor{purple}{TODO: \emph{#1}}}

\begin{document}

\begin{frontmatter}
\title{An Eulerian finite volume transport scheme for atmospheric flows on arbitrary meshes over steep terrain \\ \TODO{(working title)}}
\author[uor]{James Shaw\corref{cor}}
\ead{js102@zepler.net}
\author[uor]{Hilary Weller}

\cortext[cor]{Corresponding author}
\address[uor]{Department of Meteorology, University of Reading, Reading, United Kingdom}

\begin{abstract}
The inclusion of terrain in atmospheric models gives rise to mesh distortions and nonuniformities near the lower boundary that can degrade the accuracy of transport schemes.  In addition, accuracy may be compromised because of stringent time-to-solution constraints on operational weather forecast models.

This paper presents an Eulerian finite volume transport scheme, ``cubicFit'', that uses a multidimensional polynomial, least squares reconstruction method.  Constraints derived from a von Neumann stability analysis are imposed during model initialisation to remove high-order polynomial terms in distorted regions of the mesh, or near boundaries where there is insufficient information.  This technique achieves stable, non-oscillatory solutions on arbitrarily distorted, nonuniform meshes.  The least squares reconstruction method is computationally cheap because most calculations depend upon the mesh only.

The cubicFit scheme is evaluated using two, idealised numerical tests of atmospheric flow.  The first test assesses accuracy near the ground by transporting a tracer over steep terrain on severely distorted terrain-following meshes and cut cell meshes.  The second test deforms a tracer in non-divergent and divergent flows on hexagonal icosahedra and cubed-sphere meshes.
In all tests, cubicFit is largely insensitive to mesh distortions, and cubicFit results are more accurate than those obtained using a standard linear upwind transport scheme.
\end{abstract}

\begin{keyword}
	\TODO{keywords}
\end{keyword}
\end{frontmatter}

\section{Introduction}
\input{intro}

cubicFit motivation
\begin{itemize}
	\item finite volume is desirable because it's inherently conservative, \TODO{what else?  FV3 do it, ECMWF are doing it}
	\item a transport scheme for arbitrary meshes is desirable because different meshes offer different trade-offs (\TODO{e.g. provide example for hexagonal icosahedra vs cubed-sphere and citation}).  supporting arbitrary meshes lets us defer the choice of mesh.
	\item predicting meteorological variables at or near the surface is important because it's where we live, clouds can form near the surface, fog, pollution etc $\Rightarrow$ accurate advection is desirable
\end{itemize}

\TODO{why isn't linearUpwind good enough?  what other schemes compete with cubicFit and what can cubicFit offer in comparison with these competitors?}

\subsection{Review of existing techniques}
\textbf{What types of transport scheme are used in atmospheric models?} \\
\citep{lauritzen2014} provide a useful overview.

\textbf{How are weighted least-squares polynomial reconstructions (LSPR) used elsewhere?}
\begin{itemize}
	\item OpenFOAM has a variety of surface interpolation methods that use WLSPR, but I don't know what contexts they're used in
	\item \citep{lashley2002} developed a swept-area transport scheme that uses WLSPR.  For time-varying velocity fields, a matrix-vector multiply must be calculated for every face at every timestep.
	\item \citep{skamarock-menchaca2010} also developed a swept-area scheme using WLSPR closely following \citep{lashley2002}.
	\item \citep{skamarock-gassmann2011} use LSPR to calculate second derivatives that are used in high-order finite volume flux calculations.  Like us, coefficients are precomputed and only vector-vector multiplies are performed at runtime.  Also like us, they use multi-stage Runge-Kutta timestepping.
	\item \citep{jayantha-turner2003} use WLSPR to approximate fluxes of $\nabla \phi$ at faces in the 2D unsteady orthotropic diffusion equation
	\item Moving least squares reconstructions are applied to shallow-water equations \citep{cuetofelgueroso2006} and viscous Navier-Stokes \citep{cuetofelgueroso2007}.  They are ``moving'' because the local stencil is moved to the position of reconstruction.  They also treat cell-centre averages as point values, just as we do.
	\citep{cuetofelgueroso2007} also note that most calculations can be precomputed for static meshes.
	However, much of the description and mathematics is beyond me right now.  
	\item Another study used a least-squares reconstruction for viscous fluxes in the advection--diffusion equation \citep{olliviergooch-vanaltena2002}.  They describe a technique for constraining the fit near curved boundaries.
\end{itemize}

\textbf{Have von Neumann analyses ever been used in online numerical codes before?} \\
I've yet to find an instance where this has occurred.


\TODO{2nd order schemes that are more accurate than centred linear approximations: lipscomb-ringler2005, yeh2007, miura2007}

\section{Types of meshes}
\TODO{might ditch this section and just describe things in the intro/results sections}

\subsection{Meshing a spherical Earth}

\TODO{Describe hexagonal icosahedral meshes (cite one or more of \citep{thuburn2014,heikes-randall1995a,heikes-randall1995b})} \\
\TODO{Describe cubed-sphere mesh (cite someone?)}

Following appendix A9 in \citep{lauritzen2014}, the average equatorial spacing $\Delta \lambda$ is used as a measure of mesh spacing.  It is defined as
\begin{align}
	\Delta \lambda = \ang{360} \frac{\overline{\Delta x}}{2 \pi R_e}
\end{align}
where $\overline{\Delta x}$ is the mean distance between cell centres and $R_e = \SI{6.3712e6}{\meter}$ is the radius of the Earth.

\input{transportSchemes}

\section{Results}
\label{sec:results}

\TODO{somewhere mention that the second-order convergence is a limitation of the divergence discretisation.  With more DoF a higher order should be achievable.} \\
\TODO{should I do eigenmode analysis?  this would prove stability for particular meshes for arbitrary wind fields} \\
\TODO{somewhere define error norms}

\input{mountainAdvection}

\input{deformationSphere}

\section{Conclusions}

The advection scheme is
\begin{itemize}
	\item suitable for complex flows on a variety of meshes
	\item computationally cheap at runtime, with more expensive computations depending only on the mesh geometry
	\item \TODO{convergence}
	\item stable for Courant numbers up to 1
\end{itemize}

\section{Acknowledgements}
\TODO{Supervisors, funding bodies.  ASAM group for the mesh generator---I should ask permission to use cut cell meshes in this paper.  Dr Tristan Pryer.  Dr Shing Hing Man.}

\input{vonNeumann}

\bibliographystyle{ametsoc2014}
\bibliography{references}

\end{document}
